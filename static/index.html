<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Server Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: #e0e0e0;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            font-size: 2.5rem;
            background: linear-gradient(90deg, #00d9ff, #00ff88);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #888;
            font-size: 0.9rem;
        }

        .live-indicator {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid #00ff88;
            padding: 5px 15px;
            border-radius: 20px;
            margin-top: 10px;
            font-size: 0.85rem;
        }

        .live-indicator.offline {
            background: rgba(255, 107, 107, 0.1);
            border-color: #ff6b6b;
        }

        .live-dot {
            width: 8px;
            height: 8px;
            background: #00ff88;
            border-radius: 50%;
            animation: pulse 1.5s infinite;
        }

        .live-indicator.offline .live-dot {
            background: #ff6b6b;
            animation: none;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.2); }
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 25px;
            backdrop-filter: blur(10px);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 40px rgba(0, 217, 255, 0.2);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
        }

        .card-icon {
            font-size: 1.5rem;
        }

        .card-title {
            font-size: 1.1rem;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .card-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: #fff;
            margin-bottom: 10px;
        }

        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 15px;
        }

        .progress-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .progress-fill.cpu { background: linear-gradient(90deg, #00d9ff, #00a8ff); }
        .progress-fill.memory { background: linear-gradient(90deg, #ff6b6b, #ff8e53); }
        .progress-fill.disk { background: linear-gradient(90deg, #a855f7, #ec4899); }

        .stats-row {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 0.85rem;
            color: #888;
        }

        .network-stats {
            display: flex;
            gap: 30px;
        }

        .network-item {
            flex: 1;
        }

        .network-label {
            font-size: 0.85rem;
            color: #888;
            margin-bottom: 5px;
        }

        .network-value {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .network-value.rx { color: #00ff88; }
        .network-value.tx { color: #00d9ff; }

        .load-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            text-align: center;
        }

        .load-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
        }

        .load-label {
            font-size: 0.75rem;
            color: #888;
            margin-bottom: 5px;
        }

        .load-value {
            font-size: 1.3rem;
            font-weight: bold;
            color: #00d9ff;
        }

        footer {
            text-align: center;
            color: #666;
            font-size: 0.85rem;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .timestamp {
            font-size: 0.8rem;
            color: #666;
            text-align: center;
            margin-top: 20px;
        }

        @media (max-width: 768px) {
            h1 { font-size: 1.8rem; }
            .card-value { font-size: 2rem; }
            .grid { grid-template-columns: 1fr; }
            .network-card { grid-column: span 1 !important; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1 id="title">SERVER DASHBOARD</h1>
            <p class="subtitle">Real-time System Monitoring</p>
            <div class="live-indicator" id="status-indicator">
                <span class="live-dot"></span>
                <span id="status-text">LIVE</span>
            </div>
        </header>

        <div class="grid">
            <!-- CPU Card -->
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">&#9889;</span>
                    <span class="card-title">CPU Usage</span>
                </div>
                <div class="card-value" id="cpu-value">---%</div>
                <div class="progress-bar">
                    <div class="progress-fill cpu" id="cpu-bar" style="width: 0%"></div>
                </div>
                <div class="stats-row">
                    <span>Load: <span id="load-1">--</span></span>
                    <span id="hostname">---</span>
                </div>
            </div>

            <!-- Memory Card -->
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">&#129504;</span>
                    <span class="card-title">Memory</span>
                </div>
                <div class="card-value" id="mem-value">---%</div>
                <div class="progress-bar">
                    <div class="progress-fill memory" id="mem-bar" style="width: 0%"></div>
                </div>
                <div class="stats-row">
                    <span id="mem-used">-- GB used</span>
                    <span id="mem-total">-- GB total</span>
                </div>
            </div>

            <!-- Disk Card -->
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">&#128190;</span>
                    <span class="card-title">Disk Space</span>
                </div>
                <div class="card-value" id="disk-value">---%</div>
                <div class="progress-bar">
                    <div class="progress-fill disk" id="disk-bar" style="width: 0%"></div>
                </div>
                <div class="stats-row">
                    <span id="disk-used">-- GB used</span>
                    <span id="disk-total">-- GB total</span>
                </div>
            </div>

            <!-- Uptime Card -->
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">&#9201;</span>
                    <span class="card-title">Uptime</span>
                </div>
                <div class="card-value" id="uptime-value">---</div>
                <div class="load-grid">
                    <div class="load-item">
                        <div class="load-label">1 min</div>
                        <div class="load-value" id="load-1m">--</div>
                    </div>
                    <div class="load-item">
                        <div class="load-label">5 min</div>
                        <div class="load-value" id="load-5m">--</div>
                    </div>
                    <div class="load-item">
                        <div class="load-label">15 min</div>
                        <div class="load-value" id="load-15m">--</div>
                    </div>
                </div>
            </div>

            <!-- Network Card -->
            <div class="card network-card" style="grid-column: span 2;">
                <div class="card-header">
                    <span class="card-icon">&#127760;</span>
                    <span class="card-title">Network Traffic</span>
                </div>
                <div class="network-stats">
                    <div class="network-item">
                        <div class="network-label">&#8595; Received</div>
                        <div class="network-value rx" id="net-rx">-- GB</div>
                    </div>
                    <div class="network-item">
                        <div class="network-label">&#8593; Sent</div>
                        <div class="network-value tx" id="net-tx">-- GB</div>
                    </div>
                </div>
            </div>
        </div>

        <p class="timestamp">Last updated: <span id="timestamp">---</span></p>

        <footer>
            <p>Server Dashboard | Powered by Go</p>
        </footer>
    </div>

    <script>
        function formatBytes(bytes) {
            if (bytes === 0) return '0 B';
            const k = 1024;
            const sizes = ['B', 'KB', 'MB', 'GB', 'TB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
        }

        function formatBytesGB(bytes) {
            return (bytes / (1024 * 1024 * 1024)).toFixed(1) + ' GB';
        }

        function setOffline() {
            const indicator = document.getElementById('status-indicator');
            const statusText = document.getElementById('status-text');
            indicator.classList.add('offline');
            statusText.textContent = 'OFFLINE';
        }

        function setOnline() {
            const indicator = document.getElementById('status-indicator');
            const statusText = document.getElementById('status-text');
            indicator.classList.remove('offline');
            statusText.textContent = 'LIVE';
        }

        async function updateStats() {
            try {
                const response = await fetch('/api/stats');
                if (!response.ok) throw new Error('API error');
                const data = await response.json();

                setOnline();

                // CPU
                document.getElementById('cpu-value').textContent = data.cpu_percent + '%';
                document.getElementById('cpu-bar').style.width = data.cpu_percent + '%';
                document.getElementById('hostname').textContent = data.hostname;
                document.getElementById('load-1').textContent = data.load['1min'];

                // Memory
                document.getElementById('mem-value').textContent = data.memory.percent + '%';
                document.getElementById('mem-bar').style.width = data.memory.percent + '%';
                document.getElementById('mem-used').textContent = formatBytesGB(data.memory.used) + ' used';
                document.getElementById('mem-total').textContent = formatBytesGB(data.memory.total) + ' total';

                // Disk
                document.getElementById('disk-value').textContent = data.disk.percent + '%';
                document.getElementById('disk-bar').style.width = data.disk.percent + '%';
                document.getElementById('disk-used').textContent = formatBytesGB(data.disk.used) + ' used';
                document.getElementById('disk-total').textContent = formatBytesGB(data.disk.total) + ' total';

                // Uptime & Load
                document.getElementById('uptime-value').textContent = data.uptime;
                document.getElementById('load-1m').textContent = data.load['1min'];
                document.getElementById('load-5m').textContent = data.load['5min'];
                document.getElementById('load-15m').textContent = data.load['15min'];

                // Network
                document.getElementById('net-rx').textContent = formatBytes(data.network.bytes_recv);
                document.getElementById('net-tx').textContent = formatBytes(data.network.bytes_sent);

                // Timestamp
                const ts = new Date(data.timestamp);
                document.getElementById('timestamp').textContent = ts.toLocaleString();

                // Update title with hostname
                document.getElementById('title').textContent = data.hostname.toUpperCase();

            } catch (error) {
                console.error('Failed to fetch stats:', error);
                setOffline();
            }
        }

        // Initial update
        updateStats();

        // Auto-refresh every 5 seconds
        setInterval(updateStats, 5000);
    </script>
</body>
</html>
